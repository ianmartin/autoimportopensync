LINK_DIRECTORIES( ${OPENSYNC_LIBRARY_DIRS} ${GLIB2_LIBRARY_DIRS} )
INCLUDE_DIRECTORIES( ${CMAKE_CURRENT_SOURCE_DIR} ${CMAKE_BINARY_DIR} ${CHECK_INCLUDE_DIR} ${OPENSYNC_INCLUDE_DIRS} ${GLIB2_INCLUDE_DIRS} )

########### support #################	
ADD_DEFINITIONS( -DOPENSYNC_FORMATSDIR="\\\"${OPENSYNC_FORMATSDIR}\\\"" )

ADD_LIBRARY( support STATIC support.c )
TARGET_LINK_LIBRARIES( support opensync ${CHECK_LIBRARIES} ${OPENSYNC_LIBRARIES} ${GLIB2_LIBRARIES} )

ADD_LIBRARY( conversion STATIC conversion.c )
TARGET_LINK_LIBRARIES( conversion opensync ${CHECK_LIBRARIES} ${OPENSYNC_LIBRARIES} ${GLIB2_LIBRARIES} )

############ unit tests ##########################	

SET( TEST_TARGET_LIBRARIES support conversion )

IF ( BUILD_CONTACT )
	ADD_CHECK_TEST( vcard check_vcard.c ${TEST_TARGET_LIBRARIES}  )
ENDIF ( BUILD_CONTACT )
IF ( BUILD_CALENDAR )
	ADD_CHECK_TEST( vevent check_vevent.c ${TEST_TARGET_LIBRARIES} )
	ADD_CHECK_TEST( vtodo check_vtodo.c ${TEST_TARGET_LIBRARIES} )
ENDIF ( BUILD_CALENDAR )

IF ( BUILD_NOTE )
	ADD_CHECK_TEST( vnote check_vnote.c ${TEST_TARGET_LIBRARIES} )
ENDIF ( BUILD_NOTE )

